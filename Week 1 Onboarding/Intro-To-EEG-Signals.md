# Module 1: Understanding EEG Signals and Data Representation

---

## Introduction

Welcome to Module 1 of the onboarding series! In this module, we'll explore the basics of Electroencephalography (EEG) signals and how they are represented as data. This module is designed to give you a foundational understanding of EEG signals, which is essential for working on projects at Longhorn Neurotech.

---

## Table of Contents

1. [What is EEG?](#what-is-eeg)
2. [EEG Signal Characteristics](#eeg-signal-characteristics)
   - [EEG Frequency Bands](#eeg-frequency-bands)
3. [EEG Data Representation](#eeg-data-representation)
   - [Data Structures](#data-structures)
   - [Common File Formats](#common-file-formats)
4. [Introduction to Python Libraries](#introduction-to-python-libraries)
   - [NumPy](#numpy)
   - [SciPy](#scipy)
   - [MNE-Python](#mne-python)
   - [PyTorch](#pytorch)
5. [Visualizing EEG Signals](#visualizing-eeg-signals)
   - [Plotting Raw EEG Data](#plotting-raw-eeg-data)
   - [Visualizing Signal from a Single Channel](#visualizing-signal-from-a-single-channel)
   - [Spectral Analysis](#spectral-analysis)
   - [Power Spectral Density (PSD) Explained](#power-spectral-density-psd-explained)
   - [Computing PSD with SciPy](#computing-psd-with-scipy)
6. [Additional Key Concepts](#additional-key-concepts)
   - [Artifacts and Noise](#artifacts-and-noise)
   - [Spatial Resolution of EEG](#spatial-resolution-of-eeg)
7. [Mini-Project](#mini-project)
8. [Conclusion](#conclusion)

---

## What is EEG?

Electroencephalography (EEG) is a non-invasive method used to record the electrical activity of the brain. EEG measures voltage fluctuations resulting from ionic current flows within neurons in the brain.

**Key Points:**

- **Non-invasive:** EEG electrodes are placed along the scalp.
- **Temporal Resolution:** High temporal resolution, capturing rapid changes in brain activity.
- **Spatial Resolution:** Relatively low spatial resolution compared to other imaging techniques like fMRI. This is because EEG signals are averaged over large areas of the scalp and the electrical activity must pass through the skull and other tissues, which blurs the spatial information.
- **Portability:** EEG systems can be portable, allowing for more flexible experimental setups.

**Why EEG Has Poor Spatial Resolution:**

EEG's spatial resolution is limited due to several factors:

1. **Signal Attenuation and Distortion:** The electrical signals generated by neuronal activity must pass through the skull, scalp, and other tissues, which attenuate and distort the signals, making it difficult to pinpoint their exact origin.
2. **Volume Conduction:** Electrical activity spreads out as it travels through the conductive tissues, causing signals from multiple brain regions to overlap.
3. **Number of Electrodes:** While modern EEG systems can have many electrodes, they still cover only a limited number of scalp locations compared to the vast number of neurons involved in brain activity.

---

## EEG Signal Characteristics

EEG signals are complex and consist of various frequency components associated with different brain states and functions.

### EEG Frequency Bands

EEG signals are typically divided into different frequency bands, each associated with specific cognitive or physiological states.

| **Band** | **Frequency Range (Hz)** | **Associated States**                |
|----------|--------------------------|--------------------------------------|
| Delta    | 0.5 - 4                  | Deep sleep                           |
| Theta    | 4 - 8                    | Drowsiness, meditation               |
| Alpha    | 8 - 13                   | Relaxed wakefulness, eyes closed     |
| Beta     | 13 - 30                  | Active thinking, focus, alertness    |
| Gamma    | 30 - 100                 | High-level information processing    |

---

## EEG Data Representation

### Data Structures

EEG data is typically represented as a multi-dimensional array:

- **Channels (Electrodes):** Spatial dimension representing different locations on the scalp.
- **Time Points (Samples):** Temporal dimension representing the signal over time.
- **Trials (Epochs):** Repeated measurements or segments of data.

**Example Structure:**

```
Trials x Channels x Time Points
```

### Common File Formats

- **.edf (European Data Format):** Standard format for EEG data.
- **.fif (Functional Image File Format):** Used by MNE-Python.
- **.bdf, .set, .gdf:** Other formats depending on the recording equipment.

---

## Introduction to Python Libraries

We'll be using several Python libraries throughout this module.

### NumPy

NumPy is a fundamental package for scientific computing in Python. It provides support for large, multi-dimensional arrays and matrices.

```python
import numpy as np
```

### SciPy

SciPy builds on NumPy and provides additional functionality for scientific computing, including signal processing tools.

```python
from scipy import signal
```

### MNE-Python

MNE-Python is an open-source package for processing EEG and MEG data.

```python
import mne
```

---

## Visualizing EEG Signals

Visualization is a crucial step in understanding EEG data. We'll use MNE-Python and Matplotlib for visualization.

### **Assuming EEG Data is Loaded**

*At this point, assume that EEG data has been loaded into a variable called `raw_eeg_data`.*

---

### Plotting Raw EEG Data

```python
# Plot raw EEG data using MNE-Python
raw_eeg_data.plot(n_channels=10, scalings='auto')
```

### Visualizing Signal from a Single Channel

```python
# Select data from a single channel
channel_data = raw_eeg_data.get_data(picks=['EEG 001'])[0]

# Plot the signal
import matplotlib.pyplot as plt

plt.figure(figsize=(15, 5))
plt.plot(raw_eeg_data.times, channel_data)
plt.title('EEG Signal from Channel EEG 001')
plt.xlabel('Time (s)')
plt.ylabel('Amplitude (µV)')
plt.show()
```

### Spectral Analysis

```python
# Compute the power spectral density (PSD) using MNE-Python
psds, freqs = mne.time_frequency.psd_welch(raw_eeg_data, fmin=0.5, fmax=50.0, picks=['EEG 001'])

# Plot PSD
plt.figure(figsize=(10, 5))
plt.semilogy(freqs, psds[0], label='EEG 001')
plt.title('Power Spectral Density')
plt.xlabel('Frequency (Hz)')
plt.ylabel('PSD (dB/Hz)')
plt.legend()
plt.show()
```

### Power Spectral Density (PSD) Explained

**What is PSD?**

Power Spectral Density (PSD) is a measure of the power distribution of a signal as a function of frequency. It shows how the power of a signal or time series is distributed across different frequency components.

**Why is PSD Important?**

1. **Frequency Analysis:** PSD allows us to identify the dominant frequencies present in EEG signals, which are associated with different brain states and cognitive processes.
2. **Feature Extraction:** In applications like motor imagery for Brain-Computer Interfaces (BCIs), specific frequency bands (e.g., mu and beta bands) are targeted. Analyzing PSD helps in extracting relevant features for classification and interpretation.
3. **Signal Quality Assessment:** PSD can help in identifying artifacts and noise by revealing unexpected frequency components.

**Connection to Motor Imagery:**

In motor imagery tasks, individuals imagine performing a movement (e.g., moving a limb) without actual execution. This mental activity induces changes in specific EEG frequency bands, particularly the mu (8-13 Hz) and beta (13-30 Hz) bands. By analyzing the PSD, we can detect these changes, which are crucial for developing BCIs that translate motor imagery into control signals for external devices.

---

### Computing PSD with SciPy

In addition to MNE-Python, SciPy can be used to compute the PSD using methods like Welch's method.

```python
# Select data from a single channel
channel_data = raw_eeg_data.get_data(picks=['EEG 001'])[0]

# Compute PSD using SciPy
frequencies, psd_values = signal.welch(channel_data, 
                                       fs=raw_eeg_data.info['sfreq'], 
                                       nperseg=1024, 
                                       scaling='density')

# Plot PSD
plt.figure(figsize=(10, 5))
plt.semilogy(frequencies, psd_values, label='EEG 001 (SciPy)')
plt.title('Power Spectral Density using SciPy')
plt.xlabel('Frequency (Hz)')
plt.ylabel('PSD (V²/Hz)')
plt.legend()
plt.show()
```

**Comparison Between MNE-Python and SciPy:**

- **MNE-Python:** Tailored for neurophysiological data, integrates seamlessly with EEG data structures, and offers advanced options specific to EEG analysis.
- **SciPy:** General-purpose scientific computing library, offering flexibility and control over signal processing tasks but requires manual handling of EEG-specific data structures.

Both methods provide valuable insights, and the choice depends on the specific requirements of your analysis.

---

## Additional Key Concepts

### Artifacts and Noise

**Artifacts:** Unwanted signals in EEG data that are not related to brain activity. Common artifacts include:

- **Eye Blinks and Movements:** Generate large voltage changes, especially in frontal electrodes.
- **Muscle Activity (EMG):** High-frequency noise resulting from muscle contractions.
- **Heartbeat (ECG):** Periodic artifacts related to the cardiac cycle.
- **Environmental Noise:** Electrical interference from equipment or external sources.

**Importance:**

Understanding and identifying artifacts is crucial for ensuring data quality and the accuracy of subsequent analyses. While artifact removal (filtering) will be discussed in a later section, being aware of common artifacts helps in interpreting raw EEG signals.

### Spatial Resolution of EEG

As previously mentioned, EEG has relatively poor spatial resolution compared to other neuroimaging techniques like fMRI. This limitation affects:

- **Localization:** Difficulty in precisely identifying the exact brain regions generating the observed electrical activity.
- **Interpretation:** Caution is needed when linking EEG signals to specific cognitive or motor functions due to the overlapping and diffuse nature of the electrical signals.

**Implications for Motor Imagery:**

When working with motor imagery, the low spatial resolution means that while we can detect changes in frequency bands associated with motor areas (e.g., mu and beta rhythms), pinpointing the exact neural sources requires additional methods or complementary imaging techniques.

---

## Mini-Project

### Objective

- Visualize EEG signals from multiple channels.
- Identify and label different EEG frequency bands in the spectral analysis.

### Instructions

1. **Select Multiple Channels:**
   - Choose at least 3 different EEG channels from the dataset.

2. **Time-Domain Visualization:**
   - Plot the time-series data for each selected channel.
   - Annotate any noticeable patterns or events.

3. **Frequency-Domain Analysis:**
   - Compute and plot the Power Spectral Density (PSD) for each channel using both MNE-Python and SciPy.
   - Identify peaks corresponding to different EEG frequency bands.

4. **Interpretation:**
   - Write a brief analysis explaining the observed patterns in both time and frequency domains.
   - Discuss any differences between channels.

### Tips

- Use `raw_eeg_data.plot()` and `matplotlib` for plotting.
- Refer to the frequency bands table to identify different components.
- Ensure plots are well-labeled and readable.
- Leverage both MNE-Python and SciPy for computing PSD to compare results.

---

## Conclusion

In this module, we've covered the basics of EEG signals, how they are represented as data, and how to visualize them using Python libraries. We delved deeper into understanding Power Spectral Density (PSD) and its importance in analyzing EEG data, particularly in applications like motor imagery for Brain-Computer Interfaces (BCIs). Additionally, we explored key concepts such as artifacts, noise, and the spatial resolution limitations of EEG. Understanding these fundamentals is crucial as we delve deeper into signal processing and analysis in the subsequent modules.

---
